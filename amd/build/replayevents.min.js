define ("logstore_xapi/replayevents",["core/str","core/config","core/notification","core/templates","jquery","jqueryui"],function(a,b,c,d,f){var e=0,g="",h="",i="",j="",k={CHECKBOXES:"#xapierrorlog_form .form-check-input",CHECKBOX_DATEFROM:"#xapierrorlog_form #id_datefrom_enabled",CHECKBOX_DATETO:"#xapierrorlog_form #id_dateto_enabled",PAGE_LINKS:".pagination .page-item .page-link",RESEND_BUTTON:"#xapierrorlog_form #id_resendselected",REPLAY_EVENTS:"#xapierrorlog_data .reply-event",SELECTS:"#xapierrorlog_form .custom-select",SELECT_ERRORTYPE:"#xapierrorlog_form #id_errortype",SELECT_EVENTNAME:"#xapierrorlog_form #id_eventname",SELECT_RESPONSE:"#xapierrorlog_form #id_response",SELECT_DATAFROM:"#xapierrorlog_form #id_datefrom .custom-select",SELECT_DATATO:"#xapierrorlog_form #id_dateto .custom-select",SUBMIT_FORM:"#xapierrorlog_form #id_submitbutton"},l="reply-event-id-";return{init:function init(a){e=a;this.disableResend();this.updateResend();this.addReplyEvents()},addReplyEvents:function addReplyEvents(){if(0==f(k.REPLAY_EVENTS).length){return}this.generateLoadHTML();this.generateDoneHTML();this.generateFailedHTML();this.generateReplayHTML();this.registerReplyEventListeners()},registerReplyEventListeners:function registerReplyEventListeners(){var a=this;f(k.REPLAY_EVENTS).click(function(b){b.stopPropagation();b.preventDefault();a.disableFormControls();a.disablePagination();var c=f(this);c.off("click");c.addClass("disabled");var d=c.attr("id"),e=d.replace(l,"");a.doReplayEvent(e)})},doReplayEvent:function doReplayEvent(a){var d=b.wwwroot+"/admin/tool/log/store/xapi/ajax/moveback_to_log.php",e=this,h=f("#"+l+a);h.empty();h.append(g);h.removeClass("reply-event");f.ajax({type:"POST",url:d,data:{events:[a],sesskey:M.cfg.sesskey},success:function success(a){h.empty();if(a.success){h.append(i)}else{h.append(j)}e.enableFormControls();e.enablePagination()},fail:function fail(a){c.exception(a);h.empty();h.append(j);e.enableFormControls();e.enablePagination()}})},updateResend:function updateResend(){var b=f(k.RESEND_BUTTON),c=this;a.get_strings([{key:"resendevents",component:"logstore_xapi",param:{count:e}}]).done(function(a){b.attr("Value",a);if(0!=e){c.enableResend()}})},disableElements:function disableElements(a){a.addClass("disabled");a.attr("disabled","disabled");a.prop("disabled",!0)},enableElements:function enableElements(a){a.removeClass("disabled");a.prop("disabled",!1);a.removeAttr("disabled")},disablePagination:function disablePagination(){if(0==f(k.PAGE_LINKS).length){return}var a=f(k.PAGE_LINKS);this.disableElements(a);a.bind("click",function(a){a.preventDefault()})},enablePagination:function enablePagination(){if(0==f(k.PAGE_LINKS).length){return}var a=f(k.PAGE_LINKS);this.enableElements(a);a.unbind("click")},disableResend:function disableResend(){this.disableElements(f(k.RESEND_BUTTON))},enableResend:function enableResend(){this.enableElements(f(k.RESEND_BUTTON))},disableReplyEvents:function disableReplyEvents(){f(k.REPLAY_EVENTS).off("click");this.disableElements(f(k.REPLAY_EVENTS))},enableReplyEvents:function enableReplyEvents(){this.enableElements(f(k.REPLAY_EVENTS));this.registerReplyEventListeners()},disableFormSubmit:function disableFormSubmit(){this.disableElements(f(k.SUBMIT_FORM))},enableFormSubmit:function enableFormSubmit(){this.enableElements(f(k.SUBMIT_FORM))},disableFormSelects:function disableFormSelects(){this.disableElements(f(k.SELECTS))},enableFormSelects:function enableFormSelects(){this.enableElements(f(k.SELECT_ERRORTYPE));this.enableElements(f(k.SELECT_EVENTNAME));this.enableElements(f(k.SELECT_RESPONSE));if(f(k.CHECKBOX_DATEFROM).is(":checked")){this.enableElements(f(k.SELECT_DATAFROM))}if(f(k.CHECKBOX_DATETO).is(":checked")){this.enableElements(f(k.SELECT_DATATO))}},disableFormCheckboxes:function disableFormCheckboxes(){this.disableElements(f(k.CHECKBOXES))},enableFormCheckboxes:function enableFormCheckboxes(){this.enableElements(f(k.CHECKBOXES))},disableFormControls:function disableFormControls(){this.disableFormSubmit();this.disableFormCheckboxes();this.disableFormSelects();this.disableResend()},enableFormControls:function enableFormControls(){this.enableFormCheckboxes();this.enableFormSelects();this.enableFormSubmit();this.enableResend()},generateLoadHTML:function generateLoadHTML(){a.get_strings([{key:"loadinghelp",component:"moodle"}]).done(function(a){g="<span aria-hidden=\"true\" class=\"fa fa-spinner fa-spin fa-pulse\" title=\""+a+"\"></span><span class=\"sr-only\">"+a+"</span>"})},generateDoneHTML:function generateDoneHTML(){a.get_strings([{key:"success",component:"moodle"}]).done(function(a){i="<span aria-hidden=\"true\" class=\"fa fa-check\" title=\""+a+"\"></span><span class=\"sr-only\">"+a+"</span>"})},generateFailedHTML:function generateFailedHTML(){a.get_strings([{key:"failed",component:"logstore_xapi"}]).done(function(a){j="<span aria-hidden=\"true\" class=\"fa fa-remove\" title=\""+a+"\"></span><span class=\"sr-only\">"+a+"</span>"})},generateReplayHTML:function generateReplayHTML(){a.get_strings([{key:"replayevent",component:"logstore_xapi"}]).done(function(a){h="<span aria-hidden=\"true\" class=\"fa fa-repeat\" title=\""+a+"\"></span><span class=\"sr-only\">"+a+" </span>";f(k.REPLAY_EVENTS).append(h)})}}});
//# sourceMappingURL=replayevents.min.js.map
